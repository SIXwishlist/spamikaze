		Database reorganisation

In order to facilitate more flexible blocklisting, expiry, removal and
whitelisting policies, a database redesign is necessary.  Before we can
come up with such a new design, however, we should think about exactly
what we want to store in the database.

The new database layout will look something like this:

CREATE TABLE `ipentries` (
  `id` int(11) NOT NULL auto_increment,
    `date_received` int(11) NOT NULL default '0',
      `date_logged` int(11) NOT NULL default '0',
        `date_mail` int(11) NOT NULL default '0',
          `id_subject` int(11) NOT NULL default '0',
            `id_ip` int(11) NOT NULL default '0',
              PRIMARY KEY  (`id`)
              )

CREATE TABLE ipnumbers (
  id int(11) NOT NULL auto_increment,
  octa smallint(6) NOT NULL default '0',
  octb smallint(6) NOT NULL default '0',
  octc smallint(6) NOT NULL default '0',
  octd smallint(6) NOT NULL default '0',
  visible tinyint(4) NOT NULL default '0',
  PRIMARY KEY  (id),
  UNIQUE KEY idx_ip (octa,octb,octc,octd)
);
 
CREATE TABLE subjects (
  id int(11) NOT NULL auto_increment,
  subject varchar(150) NOT NULL default '',
  PRIMARY KEY  (id),
  UNIQUE KEY idx_subject (subject)
);


I (Hans W) am working on the update script that will populate the
new tables mentioned above. Currently it will collect all the unique
ip numbers from the old spammers table and store them in ipnumbers.

There is a small problem with this script since it will not add all
the timestamp entries to the ipentries table. Once it will I will add 
it to the cvs.


